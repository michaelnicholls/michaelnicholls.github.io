<script src="https://instructortools.appspot.com/getperformance.js"></script>
<html>
<h2>Upcoming live music events</h2>
<table border="1">

<tr><th>Date</th><th>Venue</th><th>Location</th><th>Act  <select id="act" onchange="filteract()"></select></th></tr>
<tbody id="body">

</tbody>
</table>
<script>
vActs = [];
document.getElementById("act").options.add(new Option("All", "All"));
showTable("All");

function filteract() {
	showTable(document.getElementById("act").value);
};
function showTable(subset) {
html = ""
for (i=0;i<performances.length;i++) {
	var d = new Date(performances[i].datetime);
	var dnames=["Sun/Dim","Mon/Lun","Tue/Mar","Wed/Mer","Thu/Jeu","Fri/Ven","Sat/Sam"];
	var dname = dnames[d.getDay()];
	var dt = dname + " "+performances[i].datetime.substr(8,2)+"/"+performances[i].datetime.substr(5,2)+" " +performances[i].datetime.substr(11);
	var venue="&nbsp;";
	var url =""
	var loc="&nbsp;";
	for (j=0;j<venues.length;j++) {
		if (venues[j].venue==performances[i].venue) {
			venue=venues[j].name;
			url=venues[j].url;
			loc=venues[j].location+" ("+venues[j].postcode+")";
		};
	};
	if (url != "") {
		venue='<a target="_new" href="'+url+'">'+venue+"</a>";	
	};
	act="&nbsp;";
	for (j=0;j<acts.length;j++) {
		if (acts[j].act==performances[i].act) {act=acts[j].name};
	};
	if (subset=="All" || subset == act) {
		html=html+"<tr><td>"+dt+"</td><td>"+venue+"</td><td>"+loc+"</td><td>"+act+"</td></tr>";
		if (subset=="All" && !vActs.includes(act)) vActs.push(act);
		};
	};
	document.getElementById("body").innerHTML= html;
	if (document.getElementById("act").options.length == 1) {
		vActs.sort();
		for (i=0;i<vActs.length;i++) {
			document.getElementById("act").options.add(new Option(vActs[i],vActs[i]));
			};
		};
	};
</script>